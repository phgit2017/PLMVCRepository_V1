var ORDERMANAGEMENTSALESORDER=function(){var n={params:null,loaderMsg:"Please wait while we process your request",UpdateMsg:"",gvProductHeight:240,gvSavedSalesOrderHeight:230,defaultSalesReceiptForm:null,defaultProductSearchForm:null},v=function(){$("body").on("click","#btnaddsalesorder",function(){p()});$("body").on("click","#btnsavesalesorder",function(){tt()});$("body").on("click","#btnclickaddsalesorder",function(){var n=$(this);e()&&w(n)});$("body").on("click","#searchproduct",function(){$("#mdlsearchproduct").modal("show")});$("body").on("click","#btnfiltersalesorder",function(){$("#mdlsearchsavedsalesorder").modal("show")});$("body").on("shown.bs.modal","#mdlsearchproduct",function(){$(document).off("focusin.modal")});$("body").on("shown.bs.modal","#mdlsearchsavedsalesorder",function(){$(document).off("focusin.modal")});$("body").on("click","#searchdetails",function(){h()});$("body").on("click","#removeitem",function(){var n=$(this);k(n)});$("body").on("blur","#changeqty",function(){var n=$(this);s(n)});$("body").on("keypress","#changeqty",function(n){var t=$(this);n.keyCode==13&&s(t)});$("body").on("click","#btnlistofsalesorder",function(){g();a()});$("body").on("click","#btnsalesorderform",function(){nt()});$("body").on("click","#refreshproduct",function(){l()});$("body").on("click","#searchsavedsalesorder",function(){f()});$("body").on("click","#btnrefreshsalesorder",function(){it()});$("body").on("click","#removeproductfilter",function(){$("#frmSearchProduct").deserialize(n.defaultProductSearchForm,!0,null)});$("body").on("click","#removesofilter",function(){$("#dpFrom").val("");$("#dpTo").val("");$("#ReceiptNumber").val("");$("#mdlsearchsavedsalesorder #SearchSOProductBranch").data("kendoDropDownList").value(null)});$("body").on("click","#refreshcustomer",function(){$("#SalesCustomer").kendoDropDownList({filter:"contains",optionLabel:"Select Customer",dataTextField:"DropdownDisplay",dataValueField:"CustomerID",dataSource:{transport:{read:{dataType:"json",url:n.params.customerGetUrl}}}})});$("body").on("click","#refreshbranch",function(){$("#SalesBranch").kendoDropDownList({filter:"contains",optionLabel:"Select All",dataTextField:"BranchName",dataValueField:"BranchId",dataSource:{transport:{read:{dataType:"json",url:n.params.branchGetUrl}}}})});$("body").on("keypress","#txtBarCode",function(n){n.which==13&&(INFRA.IsNullOrEmpty($("#txtBarCode").val())?toastr.error("Product bar code should not be blank/empty"):c())});$("body").on("click","#btnBarCode",function(){INFRA.IsNullOrEmpty($("#txtBarCode").val())?toastr.error("Product bar code should not be blank/empty"):c()})},y=function(){$("#SalesCustomer").kendoDropDownList({filter:"contains",optionLabel:"Select Customer",dataTextField:"DropdownDisplay",dataValueField:"CustomerID",dataSource:{transport:{read:{dataType:"json",url:n.params.customerGetUrl}}}});$("#SalesBranch").kendoDropDownList({filter:"contains",optionLabel:"Select Branch",dataTextField:"BranchName",dataValueField:"BranchId",dataSource:{transport:{read:{dataType:"json",url:n.params.branchGetUrl}}}});$("#dpFrom").kendoDatePicker({format:"MM/dd/yyyy"});$("#dpTo").kendoDatePicker({format:"MM/dd/yyyy"});$("#SearchProductModel").kendoDropDownList({filter:"startswith",optionLabel:"Select All",dataTextField:"ModelName",dataValueField:"ModelID",dataSource:{transport:{read:{dataType:"json",url:n.params.modelGetUrl}}}});$("#SearchProductCategory").kendoDropDownList({filter:"startswith",optionLabel:"Select All",dataTextField:"CategoryDisplay",dataValueField:"CategoryID",dataSource:{transport:{read:{dataType:"json",url:n.params.categoryGetUrl}}}});$("#SearchProductBranch").kendoDropDownList({filter:"contains",optionLabel:"Select All",dataTextField:"BranchName",dataValueField:"BranchId",dataSource:{transport:{read:{dataType:"json",url:n.params.branchGetUrl}}}});$("#SearchSOProductBranch").kendoDropDownList({filter:"contains",optionLabel:"Select All",dataTextField:"BranchName",dataValueField:"BranchId",dataSource:{transport:{read:{dataType:"json",url:n.params.branchGetUrl}}}})},u=function(n){$("body").showLoader({type:"page",message:n})},t=function(){$("body").hideLoader()},p=function(){$frmSalesOrderDetails=$("#frmSalesOrderDetails");$gvSalesOrderDetails=$("#gvSalesOrderDetails tbody");var t,i;$.ajax({url:n.params.addSalesOrderUrl,type:"POST",data:$frmSalesOrderDetails.serialize(),success:function(n){INFRA.ConvertToBoolean(n.isSuccess)&&(t=$("<table><\/table>"),t.html(n.salesOrder),i=t.find("tbody > tr"),$gvSalesOrderDetails.find("tr").length===0?$gvSalesOrderDetails.html(i):$(i).appendTo($gvSalesOrderDetails));$("#divResultContainer").show().html(n.alertMessage)}})},w=function(t){var h=t.data("product-id"),u=null,f=$("#gvSalesOrderDetails tbody"),e,s,c;$hdfUserTypeId=$("#hdfUserTypeId");INFRA.ConvertToInteger($hdfUserTypeId.val())===1&&(u=$("#SalesBranch").val());INFRA.IsNullOrEmpty(u)&&INFRA.ConvertToInteger($hdfUserTypeId.val())===1?$('#frmSalesOrder [data-valmsg-for="BranchID"]').html("<br/>Branch field is a required field"):($('#frmSalesOrder [data-valmsg-for="BranchID"]').html(""),$.ajax({url:n.params.addClickSalesOrderUrl,type:"POST",data:{productId:h,branchId:u},success:function(n){INFRA.ConvertToBoolean(n.isSuccess)&&(e=$("<table><\/table>"),e.html(n.salesOrder),s=e.find("tbody > tr"),f.find("tr").length===0?f.html(s):(c=o(h),INFRA.ConvertToBoolean(c)&&$(s).appendTo(f)),r(),i());$("#divResultContainer").show().html(n.alertMessage)}}))},b=function(t){var u=null,f=$("#gvSalesOrderDetails tbody"),e,s,h;$hdfUserTypeId=$("#hdfUserTypeId");INFRA.ConvertToInteger($hdfUserTypeId.val())===1&&(u=$("#SalesBranch").val());INFRA.IsNullOrEmpty(u)&&INFRA.ConvertToInteger($hdfUserTypeId.val())===1?$('#frmSalesOrder [data-valmsg-for="BranchID"]').html("<br/>Branch field is a required field"):($('#frmSalesOrder [data-valmsg-for="BranchID"]').html(""),$.ajax({url:n.params.addClickSalesOrderUrl,type:"POST",data:{productId:t,branchId:u},success:function(n){INFRA.ConvertToBoolean(n.isSuccess)&&(e=$("<table><\/table>"),e.html(n.salesOrder),s=e.find("tbody > tr"),f.find("tr").length===0?f.html(s):(h=o(t),INFRA.ConvertToBoolean(h)&&$(s).appendTo(f)),r(),i());$("#divResultContainer").show().html(n.alertMessage)}}))},e=function(){$gvSalesOrderDetails=$("#gvSalesOrderDetails");var n=$gvSalesOrderDetails.find("tbody > tr");return n.length>=16?(toastr.error("Product should be only 16 items"),!1):!0},o=function(n){var r=n,u=$("#gvSalesOrderDetails"),i=0,t=!0;return u.find("tbody > tr").each(function(){return $this=$(this),i=$this.data("product-id"),i==r?(toastr.error("this product is already in the order"),t=!1):t}),t},i=function(){var n=0,t=$("#gvSalesOrderDetails");t.find("tbody > tr").each(function(){$tds=$(this).find("td");var t;t=INFRA.ConvertToFloat($tds.eq(4).find("span").text());n=n+t});$("#salesordertotal").html(n)},r=function(){var n=0,t=$("#gvSalesOrderDetails");t.find("tbody > tr").each(function(){$tds=$(this).find("td");n=n+1});$("#salesordercount").html(n)},k=function(n){var t=n,u;u=t.data("product-id");t.parent().parent().parent().parent().remove();i();r()},s=function(n){var t=n,e,r,u,f;e=t.data("product-id");r=t.val();u=t.data("product-unit-price");INFRA.IsNullOrEmpty(r)||(f=r*u,t.parent().parent().parent().parent().find("td").eq(4).find("span").text(INFRA.ConvertToFloat(f).toFixed(2)));i()},d=function(){$gvSalesOrderDetails.find("tbody > tr").each(function(){$this=$(this);$this.remove()});$("#frmSalesOrder").deserialize(n.defaultSalesReceiptForm,!0,null);i();r()},g=function(){$("#divsalesorderform").hide();$("#divlistofsalesorders").show();$("#btnlistofsalesorder").hide();$("#btnsavesalesorder").hide();$("#btnsalesorderform").show()},nt=function(){$("#divlistofsalesorders").hide();$("#divsalesorderform").show();$("#btnsalesorderform").hide();$("#btnsavesalesorder").show();$("#btnlistofsalesorder").show()},tt=function(){var e=[],o,i,s=[],r=!0;u(n.loaderMsg);$frmSalesOrder=$("#frmSalesOrder");$gvSalesOrderDetails=$("#gvSalesOrderDetails");$ddlCustomer=$("#SalesCustomer");$SalesBranch=$("#SalesBranch");$gvSalesOrderDetails.find("tbody > tr").each(function(){i=$(this).find("td");var n,t,r,u,f;n=i.eq(0).find("input:hidden").eq(0).val();t=i.eq(1).find("span").find("input").val();u=i.eq(2).find("span").find("select").val();r=i.eq(3).find("span").text();f=i.eq(4).find("span").text();o={ProductID:n,Quantity:t,UnitDesc:u,UnitPrice:r,TotalPricePerItemQty:f};e.push(o)});INFRA.IsNullOrEmpty($ddlCustomer.val())?(r=!1,$('[data-valmsg-for="CustomerId"]').html("<br/>Customer field is a required field").removeClass("field-validation-valid").addClass("error"),t()):($hdfUserTypeId=$("#hdfUserTypeId"),INFRA.ConvertToInteger($hdfUserTypeId.val())===1&&(INFRA.IsNullOrEmpty($SalesBranch.val())?(r=!1,$('#frmSalesOrder [data-valmsg-for="BranchID"]').html("<br/>Branch field is a required field").removeClass("field-validation-valid").addClass("error"),t()):$('#frmSalesOrder [data-valmsg-for="BranchID"]').html("").removeClass("error")),INFRA.ConvertToBoolean(r)?(s=JSON.stringify({salesOrderDetailDto:e,customerId:$ddlCustomer.val()}),$.ajax({contentType:"application/json; charset=utf-8",type:"POST",dataType:"json",url:n.params.saveSalesOrderUrl,data:s,success:function(n){t();n.isSuccess&&(l(),$("#divSavedSalesOrder").html(n.salesOrder),f(),d());$("#divResultContainer").show().html(n.alertMessage)}})):t())},f=function(){var n=$("#gvSavedSalesOrder").data("kendoGrid"),t=$("#frmSearchSavedSalesOrder");n.dataSource.read(t.serializeToJson());$("#mdlsearchsavedsalesorder").modal("hide");INFRA.doRemoveOpenedModal()},it=function(){f()},h=function(){var i=$("#gvProduct").data("kendoGrid"),r=$("#frmSearchProduct");u(n.loaderMsg);i.dataSource.read(r.serializeToJson(),!1);t();$("#mdlsearchproduct").modal("hide");INFRA.doRemoveOpenedModal()},c=function(){var r,i,f=$("#hdfUserTypeId");r=$("#txtBarCode").val();INFRA.ConvertToInteger(f.val())===1&&(i=$("#SalesBranch").val());INFRA.IsNullOrEmpty(i)&&INFRA.ConvertToInteger(f.val())===1?$('#frmSalesOrder [data-valmsg-for="BranchID"]').html("<br/>Branch field is a required field"):($('#frmSalesOrder [data-valmsg-for="BranchID"]').html(""),u(n.loaderMsg),$.ajax({url:n.params.searchProductPerBarCodeUrl,type:"POST",data:{barCode:r,branchIdAdmin:i},success:function(n){t();INFRA.ConvertToBoolean(n.hasProduct)?e()&&b(n.list.ProductID):toastr.error("Product maybe not registered");$("#txtBarCode").val("")}}))},l=function(){h()},ft=function(){var t=$("#ProductCategory").data("kendoDropDownList");INFRA.IsNullOrEmpty(t.value())?$("#SalesProduct").kendoDropDownList({filter:"startswith",optionLabel:"Select item",dataTextField:"DropDownDisplay",dataValueField:"ProductID",dataSource:{transport:{read:{dataType:"json",url:n.params.productGetUrl}}}}):$("#SalesProduct").kendoDropDownList({filter:"startswith",optionLabel:"Select item",dataTextField:"DropDownDisplay",dataValueField:"ProductID",dataSource:{transport:{read:{dataType:"json",url:n.params.productByCategoryIdUrl,data:{categoryId:t.value()}}}}})},rt=function(){var t=$("#gvProduct");t.kGridResizeHeight({height:n.gvProductHeight,willRefreshGrid:!1,isManual:!0})},a=function(){var t=$("#gvSavedSalesOrder");t.kGridResizeHeight({height:n.gvSavedSalesOrderHeight,willRefreshGrid:!0})},ut=function(t){try{n.params=t||{}}catch(i){typeof console!="undefined"&&console!==null&&console.error("Error parsing inline options",i)}n.defaultSalesReceiptForm=$("#frmSalesOrder").serialize();n.defaultProductSearchForm=$("#frmSearchProduct").serialize();y();v();rt()};return{initialize:ut,_variables:n,BindTblSavedSalesOrder:a}}();$(document).ready(function(){var n=window.salesOptions;ORDERMANAGEMENTSALESORDER.initialize(n);ORDERMANAGEMENTSALESORDER.BindTblSavedSalesOrder();$(window).resize(function(){$("#gvProduct").kGridResizeHeight({height:ORDERMANAGEMENTSALESORDER._variables.gvProductHeight,willRefreshGrid:!1,isManual:!0});$("#gvSavedSalesOrder").kGridResizeHeight({height:ORDERMANAGEMENTSALESORDER._variables.gvSavedSalesOrderHeight,willRefreshGrid:!0})})});
//# sourceMappingURL=ordermanagement-salesorder.min.js.map
