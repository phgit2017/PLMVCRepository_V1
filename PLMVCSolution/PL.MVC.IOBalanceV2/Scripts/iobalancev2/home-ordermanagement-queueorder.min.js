var HOMEQUEUEMANAGEMENT=function(){var n={params:null,defaultSaveValue:null,defaultEditValue:null,defaultSearchValue:null,gvHeight:200,defaultSalesOrderDetailValue:null,_salesOrderId:0,_selectedRowHtml:""},u=function(){$("#divBtnList").show();$("#divListQueueOrderDetail").show();$("#divListQueue").hide()},i=function(){$("#divBtnList").hide();$("#divListQueueOrderDetail").hide();$("#divListQueue").show()},f=function(n){var t=$("#gvQueueOrderDetailList").data("kendoGrid");t.dataSource.read({salesOrderId:n})},e=function(n){var r=$("#gvQueueOrderDetailList").data("kendoGrid"),i=0,u=r.dataSource._data;return $.each(u,function(){var n=$(this)[0];i=i+1;n.SalesOrderOrder=i}),t(),n.SalesOrderOrder},o=function(n){return INFRA.CommaAdding(n.SalesPrice)},s=function(n){return INFRA.CommaAdding(n.Quantity)},h=function(n){return INFRA.CommaAdding(n.toFixed(2))},r=function(){var n=$("#gvQueueOrders").data("kendoGrid");n.dataSource.read()},c=function(t){$.ajax({url:n.params.getOrderAndOrderDetailsUrl,type:"POST",data:{salesOrderId:t},success:function(n){INFRA.IsNullOrEmpty(n.order)||($("#frmSalesOrder #SalesNo").val(n.order.SalesNo),$("#frmSalesOrder #CustomerId").val(n.order.customer.CustomerDropDownDisplay),$("#frmSalesOrder #hdfCustomerId").val(n.order.customer.CustomerId),$('*[data-toggle="tooltip"]').tooltip({container:"body",placement:"right"}))}})},l=function(t,i){$.ajax({url:n.params.getPriceUrl,type:"POST",data:{customerId:t,productId:i},success:function(n){n!=null&&$("#frmSalesOrderDetail #SalesPrice").val(n.price)}});a(i)},a=function(t){$.ajax({url:n.params.productByIdUrl,type:"GET",data:{productId:t},success:function(n){n.Quantity<=0?$("#frmSalesOrderDetail #currProdQty").html("Current Quantity: <span style='color:red'>"+n.Quantity+"<\/span>"):$("#frmSalesOrderDetail #currProdQty").html("Current Quantity: <span>"+n.Quantity+"<\/span>")}})},v=function(){var e=$("#gvQueueOrderDetailList").data("kendoGrid"),h="",o="",n="",i,f,c,r=0,u=0,s;i=$("#frmSalesOrderDetail #ProductId").data("kendoDropDownList").value();h=$("#frmSalesOrder #SalesNo").val();o=$("#frmSalesOrderDetail #ProductId").data("kendoDropDownList").text();f=$("#frmSalesOrderDetail #SalesPrice").val();r=$("#frmSalesOrderDetail #Quantity").val();i==""||i==0?(n+="please select product",u++):r==""||r==0?(n+=n==0?"quantity should be not 0":"<br/>quantity should be not 0",u++):f==""?(n+=n==0?"price should be not blank":"<br/>price should be not blank",u++):(s=!1,INFRA.IsNullOrEmpty(e._data)||($.each(e._data,function(){var t=$(this)[0],n;n=t.ProductId;n==i&&(s=!0)}),s&&(n+=n==0?"product was already added in list":"<br/>product was already added in list",u++)));u>=1?toastr.error(n):(c=f*r,e.dataSource.add({SalesNo:h,ProductId:i,ProductDisplay:o,SalesPrice:c.toFixed(2),UnitPrice:f,Quantity:r,product:{ProductDropDownDisplay:o}}),y(),t())},t=function(){var t=$("#gvQueueOrderDetailList").data("kendoGrid"),i=0,n=0;INFRA.IsNullOrEmpty(t._data)||$.each(t._data,function(){var t=$(this)[0],r=INFRA.ConvertToInteger(t.SalesPrice);n=n+r;i++});$("#divListQueueOrderDetail #gridTotal").html(INFRA.CommaAdding(n.toFixed(2)));$("#divListQueueOrderDetail #gridCount").html(i)},y=function(){$("#frmSalesOrderDetail #currProdQty").html("");$("#frmSalesOrderDetail").deserialize(n.defaultSalesOrderDetailValue,!0,null)},p=function(){var f=$("#gvQueueOrderDetailList").data("kendoGrid"),u=0,e=[],o;u=$("#frmSalesOrder #hdfCustomerId").val();INFRA.IsNullOrEmpty(f._data)?toastr.error("please fill in the details first"):u==0?toastr.error("Customer field is required"):($.each(f._data,function(){var n=$(this)[0];o={SalesNo:n.SalesNo,CustomerId:n.CustomerId,ProductId:n.ProductId,ProductDisplay:n.ProductDisplay,SalesPrice:n.SalesPrice,Quantity:n.Quantity,UnitPrice:n.UnitPrice};e.push(o)}),$(".loader-mask").show(),$.ajax({url:n.params.saveOrderUrl,type:"POST",dataType:"json",data:{dto:e,CustomerId:u,salesOrderId:n._salesOrderId},success:function(n){$(".loader-mask").hide();n.isSuccess&&t();toastr.success(n.alertMsg);i();r()}}))},w=function(){var f=$("#gvQueueOrderDetailList").data("kendoGrid"),u=0,e=[],o;u=$("#frmSalesOrder #hdfCustomerId").val();INFRA.IsNullOrEmpty(f._data)?toastr.error("please fill in the details first"):u==0?toastr.error("Customer field is required"):($.each(f._data,function(){var n=$(this)[0];o={SalesNo:n.SalesNo,CustomerId:n.CustomerId,ProductId:n.ProductId,ProductDisplay:n.ProductDisplay,SalesPrice:n.SalesPrice,Quantity:n.Quantity,UnitPrice:n.UnitPrice};e.push(o)}),$(".loader-mask").show(),$.ajax({url:n.params.queueOrderUrl,type:"POST",dataType:"json",data:{dto:e,CustomerId:u,salesOrderId:n._salesOrderId},success:function(n){$(".loader-mask").hide();n.isSuccess&&t();toastr.success(n.alertMsg);i();r()}}))},b=function(){$("body").on("click","#divListQueue #edititem",function(){$this=$(this);u();n._salesOrderId=$this.data("queue-orderid");f(n._salesOrderId);c(n._salesOrderId)});$("body").on("click","#btnDiscard",function(){i()});$("body").on("change","#frmSalesOrderDetail #ProductId",function(){var n=$("#frmSalesOrder #hdfCustomerId").val(),t=$("#frmSalesOrderDetail #ProductId").data("kendoDropDownList").value();l(n,t)});$("body").on("click","#btnAddSalesDetails",function(){v()});$("body").on("click","#removeitem",function(){$this=$(this);$this.removeClass("selected");var n=$("#gvQueueOrderDetailList").data("kendoGrid");n.removeRow($this);n.refresh();t()});$("body").on("click","#divListQueueOrderDetail #edititem",function(){$this=$(this);$('[data-edit-selected="true"]').removeClass("selected");$this.addClass("selected");$("#mdleditorderlist").modal("show")});$("body").on("shown.bs.modal","#mdleditorderlist",function(){$(document).off("focusin.modal");$("#frmEditOrderList #EditQuantity").val($this.data("orderlist-quantity"));$("#frmEditOrderList #EditPrice").val($this.data("orderlist-unitprice"));$("#EditProductName").val($this.data("orderlist-productname"))});$("body").on("hidden.bs.modal","#mdleditorderlist",function(){$("#frmEditOrderList").deserialize(n.defaultEditValue,!0,null)});$("body").on("click","#btnSaveSalesDetails",function(){p()});$("body").on("click","#btnEditOrderList",function(){var u=$("#gvQueueOrderDetailList").data("kendoGrid"),e=$('[data-edit-selected="true"].selected'),o=u.dataSource._data,n=0,i=0,f=0,r=0,t="",s=e.data("orderlist-productid");n=$("#frmEditOrderList #EditQuantity").val();i=$("#frmEditOrderList #EditPrice").val();f=i*n;n==""||n==0?(t+=t==0?"quantity should be not 0":"<br/>quantity should be not 0",r++):i==""&&(t+=t==0?"price should be not blank":"<br/>price should be not blank",r++);r>=1?toastr.error(t):($.each(o,function(){var t=$(this)[0],r;r=t.ProductId;r==s&&(t.Quantity=n,t.SalesPrice=f.toFixed(2),t.UnitPrice=i)}),$("#mdleditorderlist").modal("hide"),INFRA.doRemoveOpenedModal(),u.refresh())});$("body").on("click","#btnSaveQueueDetails",function(){w()})},k=function(){$("#frmSalesOrderDetail #ProductId").kendoDropDownList({filter:"contains",optionLabel:"- Select One -",dataTextField:"ProductDropDownDisplay",dataValueField:"ProductId",dataSource:{transport:{read:{dataType:"json",url:n.params.productUrl}}}})},d=function(t){try{n.params=t||{};b();k()}catch(i){typeof console!="undefined"&&console!==null&&console.error("Error parsing inline options",ex)}n.defaultSalesOrderDetailValue=$("#frmSalesOrderDetail").serialize();n.defaultEditValue=$("#frmEditOrderList").serialize();INFRA.doRemoveOpenedModal()};return{initialize:d,_variables:n,doRefreshOrderNumber:e,FixPriceToStringDisplay:o,FixQuantityToStringDisplay:s,FixCommaStringDisplay:h}}();$(document).ready(function(){var i=window.queueOptions,n,t;HOMEQUEUEMANAGEMENT.initialize(i);n=$("#gvQueueOrders");t=$("#gvQueueOrderDetailList");n.kGridResizeHeight({height:HOMEQUEUEMANAGEMENT._variables.gvHeight,willRefreshGrid:!1,isManual:!0});t.kGridResizeHeight({height:HOMEQUEUEMANAGEMENT._variables.gvHeight,willRefreshGrid:!1,isManual:!0});$(window).resize(function(){n.kGridResizeHeight({height:HOMEQUEUEMANAGEMENT._variables.gvHeight,willRefreshGrid:!1,isManual:!0});t.kGridResizeHeight({height:HOMEQUEUEMANAGEMENT._variables.gvHeight,willRefreshGrid:!1,isManual:!0})})});
//# sourceMappingURL=home-ordermanagement-queueorder.min.js.map
