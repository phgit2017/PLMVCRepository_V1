var ORDERMANAGEMENTSALESORDER=function(){var n={params:null,defaultSaveValue:null,defaultSalesOrderValue:null,defaultSalesOrderDetailValue:null,defaultEditValue:null,defaultSearchValue:null,defaultEditQtyValue:null,qtyType:"",gvHeight:180,gvDataHolder:null},f=function(){var s=$("#gvSalesOderList").data("kendoGrid"),c="",l="",i="",r,o,a,f=0,e=0,n=0,h;r=$("#frmSalesOrderDetail #ProductId").data("kendoDropDownList").value();c=$("#frmSalesOrder #SalesNo").val();l=$("#frmSalesOrderDetail #ProductId").data("kendoDropDownList").text();o=$("#frmSalesOrderDetail #SalesPrice").val();f=$("#frmSalesOrderDetail #Quantity").val();r==""||r==0?(i+="please select product",n++):f==""||f==0?(i+=n==0?"quantity should be not 0":"<br/>quantity should be not 0",n++):o==""?(i+=n==0?"price should be not blank":"<br/>price should be not blank",n++):(h=!1,INFRA.IsNullOrEmpty(s._data)||($.each(s._data,function(){var t=$(this)[0],n;n=t.ProductId;n==r&&(h=!0);e++}),h&&(i+=n==0?"product was already added in list":"<br/>product was already added in list",n++),e>=16&&(i+=n==0?"product list is at maximum numbers in receipt":"<br/>product list is at maximum numbers in receipt",n++)));n>=1?toastr.error(i):(a=o*f,e=e+1,s.dataSource.add({SalesOrderOrder:e,SalesNo:c,ProductId:r,ProductDisplay:l,SalesPrice:a.toFixed(2),UnitPrice:o,Quantity:f}),u(),t())},e=function(){var e=$("#gvSalesOderList").data("kendoGrid"),u="",f=0,o=[],s;u=$("#frmSalesOrder #SalesNo").val();f=$("#frmSalesOrder #CustomerId").data("kendoDropDownList").value();INFRA.IsNullOrEmpty(e._data)?toastr.error("please add order details first"):f==0||u==""?toastr.error("Customer and Sales Number field is required"):($.each(e._data,function(){var n=$(this)[0];s={SalesNo:n.SalesNo,CustomerId:n.CustomerId,ProductId:n.ProductId,ProductDisplay:n.ProductDisplay,SalesPrice:n.SalesPrice,Quantity:n.Quantity,UnitPrice:n.UnitPrice};o.push(s)}),$(".loader-mask").show(),$.ajax({url:n.params.saveOrderUrl,type:"POST",dataType:"json",data:{dto:o,SalesNo:u,CustomerId:f},success:function(u){$(".loader-mask").hide();u.isSuccess&&(i(),r(),t(),window.open(n.params.exportUrl+"?salesOrderId="+u.salesOrderId+"&salesNo="+u.salesNo+"&customerId="+u.customerId));toastr.success(u.alertMsg)}}))},o=function(){var e=$("#gvSalesOderList").data("kendoGrid"),u="",f=0,o=[],s;u=$("#frmSalesOrder #SalesNo").val();f=$("#frmSalesOrder #CustomerId").data("kendoDropDownList").value();INFRA.IsNullOrEmpty(e._data)?toastr.error("please fill in the details first"):f==0||u==""?toastr.error("Customer and Sales Number field is required"):($.each(e._data,function(){var n=$(this)[0];s={SalesNo:n.SalesNo,CustomerId:n.CustomerId,ProductId:n.ProductId,ProductDisplay:n.ProductDisplay,SalesPrice:n.SalesPrice,Quantity:n.Quantity,UnitPrice:n.UnitPrice};o.push(s)}),$(".loader-mask").show(),$.ajax({url:n.params.queueOrderUrl,type:"POST",dataType:"json",data:{dto:o,SalesNo:u,CustomerId:f},success:function(n){$(".loader-mask").hide();n.isSuccess&&(i(),r(),t());toastr.success(n.alertMsg)}}))},r=function(){$("#frmSalesOrder").deserialize(n.defaultSalesOrderValue,!0,null);u();$("#gvSalesOderList").data("kendoGrid").dataSource.data([])},i=function(){$.ajax({url:n.params.getSalesNumUrl,type:"POST",success:function(n){n.isSuccess&&$("#frmSalesOrder #SalesNo").val(n.SalesNum)}})},s=function(t,i){$.ajax({url:n.params.getPriceUrl,type:"POST",data:{customerId:t,productId:i},success:function(n){n!=null&&$("#frmSalesOrderDetail #SalesPrice").val(n.price)}});c(i)},t=function(){var t=$("#gvSalesOderList").data("kendoGrid"),i=0,n=0;INFRA.IsNullOrEmpty(t._data)||$.each(t._data,function(){var t=$(this)[0],r=INFRA.ConvertToInteger(t.SalesPrice);n=n+r;i++});$("#divList #gridTotal").html(INFRA.CommaAdding(n.toFixed(2)));$("#divList #gridCount").html(i)},h=function(n){return INFRA.CommaAdding(n.SalesPrice)},u=function(){$("#frmSalesOrderDetail #currProdQty").html("");$("#frmSalesOrderDetail").deserialize(n.defaultSalesOrderDetailValue,!0,null)},c=function(t){$.ajax({url:n.params.productByIdUrl,type:"GET",data:{productId:t},success:function(n){n.Quantity<=0?$("#frmSalesOrderDetail #currProdQty").html("Current Quantity: <span style='color:red'>"+n.Quantity+"<\/span>"):$("#frmSalesOrderDetail #currProdQty").html("Current Quantity: <span>"+n.Quantity+"<\/span>");$('*[data-toggle="tooltip"]').tooltip({container:"body",placement:"right"})}})},l=function(){$("body").on("click","#btnnewform",function(){_doShowSaveForm()});$("body").on("click","#btnAddSalesDetails",function(){f()});$("body").on("click","#edititem",function(){$this=$(this);$('[data-edit-selected="true"]').removeClass("selected");$this.addClass("selected");$("#mdleditorderlist").modal({show:!0,backdrop:"static",keyboard:!1})});$("body").on("click","#removeitem",function(){$this=$(this);$this.removeClass("selected");var n=$("#gvSalesOderList").data("kendoGrid");n.removeRow($this);n.refresh();t()});$("body").on("shown.bs.modal","#mdleditorderlist",function(){$(document).off("focusin.modal");$("#frmEditOrderList #EditQuantity").val($this.data("orderlist-quantity"));$("#frmEditOrderList #EditPrice").val($this.data("orderlist-unitprice"));$("#mdleditorderlist #EditProductName").html($this.data("orderlist-productname"))});$("body").on("hidden.bs.modal","#mdleditorderlist",function(){$("#frmEditOrderList").deserialize(n.defaultEditValue,!0,null)});$("body").on("change","#frmSalesOrderDetail #ProductId",function(){var n=$("#frmSalesOrder #CustomerId").data("kendoDropDownList").value(),t=$("#frmSalesOrderDetail #ProductId").data("kendoDropDownList").value();n==""||n==0?toastr.error("please select customer first"):s(n,t)});$("body").on("click","#btnSaveSalesDetails",function(){e()});$("body").on("click","#btnSaveQueueDetails",function(){o()});$("body").on("click","#btnEditOrderList",function(){var f=$("#gvSalesOderList").data("kendoGrid"),o=$('[data-edit-selected="true"].selected'),r=$("#frmEditOrderList");if($.validator.unobtrusive.parse(r),r.validate(),r.valid()){var s=f.dataSource._data,n=0,i=0,e=0,u=0,t="",h=o.data("orderlist-productid");n=$("#frmEditOrderList #EditQuantity").val();i=$("#frmEditOrderList #EditPrice").val();e=i*n;n==""||n==0?(t+=t==0?"quantity should be not 0":"<br/>quantity should be not 0",u++):i==""&&(t+=t==0?"price should be not blank":"<br/>price should be not blank",u++);u>=1?toastr.error(t):($.each(s,function(){var t=$(this)[0],r;r=t.ProductId;r==h&&(t.Quantity=n,t.SalesPrice=e.toFixed(2),t.UnitPrice=i)}),f.refresh(),$("#mdleditorderlist").modal("hide"),INFRA.doRemoveOpenedModal())}else $(".loader-mask").hide(),toastr.error("An error occured during the process. Please check the details or the required fields.")})},a=function(){$("#frmSalesOrder #CustomerId").kendoDropDownList({filter:"contains",optionLabel:"- Select One -",dataTextField:"CustomerDropDownDisplay",dataValueField:"CustomerId",dataSource:{transport:{read:{dataType:"json",url:n.params.customerUrl}}}});$("#frmSalesOrderDetail #ProductId").kendoDropDownList({filter:"contains",optionLabel:"- Select One -",dataTextField:"ProductDropDownDisplay",dataValueField:"ProductId",dataSource:{transport:{read:{dataType:"json",url:n.params.productUrl}}}})},v=function(r){try{n.params=r||{};l();a()}catch(u){typeof console!="undefined"&&console!==null&&console.error("Error parsing inline options",ex)}n.defaultSaveValue=$("#frmSave").serialize();n.defaultEditValue=$("#frmEditOrderList").serialize();n.defaultSalesOrderDetailValue=$("#frmSalesOrderDetail").serialize();n.defaultSalesOrderValue=$("#frmSalesOrder").serialize();n.defaultEditQtyValue=$("#frmEditQty").serialize();n.defaultSearchValue=$("#frmSearch").serialize();n.qtyType="";i();t()};return{initialize:v,_variables:n,FixPriceToStringDisplay:h}}();$(document).ready(function(){var t=window.salesOrderOptions,n;ORDERMANAGEMENTSALESORDER.initialize(t);n=$("#gvSalesOderList");n.kGridResizeHeight({height:ORDERMANAGEMENTSALESORDER._variables.gvHeight,willRefreshGrid:!1,isManual:!0});$(window).resize(function(){n.kGridResizeHeight({height:ORDERMANAGEMENTSALESORDER._variables.gvHeight,willRefreshGrid:!1,isManual:!0})})});
//# sourceMappingURL=ordermanagement-salesorder.min.js.map
