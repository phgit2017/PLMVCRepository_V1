var ORDERMANAGEMENTSALESORDER=function(){var n={params:null,defaultSaveValue:null,defaultSalesOrderValue:null,defaultSalesOrderDetailValue:null,defaultEditValue:null,defaultSearchValue:null,defaultEditQtyValue:null,qtyType:"",gvHeight:180,gvDataHolder:null},f=function(){var e=$("#gvSalesOderList").data("kendoGrid"),h="",c="",n="",i,o,l,r=0,f=0,s;i=$("#frmSalesOrderDetail #ProductId").data("kendoDropDownList").value();h=$("#frmSalesOrder #SalesNo").val();c=$("#frmSalesOrderDetail #ProductId").data("kendoDropDownList").text();o=$("#frmSalesOrderDetail #SalesPrice").val();r=$("#frmSalesOrderDetail #Quantity").val();i==""||i==0?(n+="please select product",f++):r==""||r==0?(n+=n==0?"quantity should be not 0":"<br/>quantity should be not 0",f++):(s=!1,INFRA.IsNullOrEmpty(e._data)||($.each(e._data,function(){var t=$(this)[0],n;n=t.ProductId;n==i&&(s=!0)}),s&&(n+=n==0?"product was already added in list":"<br/>product was already added in list",f++)));f>=1?toastr.error(n):(l=o*r,e.dataSource.add({SalesNo:h,ProductId:i,ProductDisplay:c,SalesPrice:l.toFixed(2),UnitPrice:o,Quantity:r}),u(),t())},e=function(){var u=$("#gvSalesOderList").data("kendoGrid"),f="",e=0,o=[],s;f=$("#frmSalesOrder #SalesNo").val();e=$("#frmSalesOrder #CustomerId").data("kendoDropDownList").value();INFRA.IsNullOrEmpty(u._data)?toastr.error("please fill in the details first"):($.each(u._data,function(){var n=$(this)[0];s={SalesNo:n.SalesNo,CustomerId:n.CustomerId,ProductId:n.ProductId,ProductDisplay:n.ProductDisplay,SalesPrice:n.SalesPrice,Quantity:n.Quantity,UnitPrice:n.UnitPrice};o.push(s)}),$.ajax({url:n.params.saveOrderUrl,type:"POST",dataType:"json",data:{dto:o,SalesNo:f,CustomerId:e},success:function(n){n.isSuccess&&(i(),r(),t());toastr.success(n.alertMsg)}}))},o=function(){var u=$("#gvSalesOderList").data("kendoGrid"),f="",e=0,o=[],s;f=$("#frmSalesOrder #SalesNo").val();e=$("#frmSalesOrder #CustomerId").data("kendoDropDownList").value();INFRA.IsNullOrEmpty(u._data)?toastr.error("please fill in the details first"):($.each(u._data,function(){var n=$(this)[0];s={SalesNo:n.SalesNo,CustomerId:n.CustomerId,ProductId:n.ProductId,ProductDisplay:n.ProductDisplay,SalesPrice:n.SalesPrice,Quantity:n.Quantity,UnitPrice:n.UnitPrice};o.push(s)}),$.ajax({url:n.params.queueOrderUrl,type:"POST",dataType:"json",data:{dto:o,SalesNo:f,CustomerId:e},success:function(n){n.isSuccess&&(i(),r(),t());toastr.success(n.alertMsg)}}))},r=function(){$("#frmSalesOrder").deserialize(n.defaultSalesOrderValue,!0,null);u();$("#gvSalesOderList").data("kendoGrid").dataSource.data([])},i=function(){$.ajax({url:n.params.getSalesNumUrl,type:"POST",success:function(n){n.isSuccess&&$("#frmSalesOrder #SalesNo").val(n.SalesNum)}})},s=function(t,i){$.ajax({url:n.params.getPriceUrl,type:"POST",data:{customerId:t,productId:i},success:function(n){n!=null&&$("#frmSalesOrderDetail #SalesPrice").val(n.price)}});h(i)},t=function(){var t=$("#gvSalesOderList").data("kendoGrid"),i=0,n=0;INFRA.IsNullOrEmpty(t._data)||$.each(t._data,function(){var t=$(this)[0],r=INFRA.ConvertToInteger(t.SalesPrice);n=n+r;i++});$("#divList #gridTotal").html(n.toFixed(2));$("#divList #gridCount").html(i)},u=function(){$("#frmSalesOrderDetail #currProdQty").html("");$("#frmSalesOrderDetail").deserialize(n.defaultSalesOrderDetailValue,!0,null)},h=function(t){$.ajax({url:n.params.productByIdUrl,type:"GET",data:{productId:t},success:function(n){$("#frmSalesOrderDetail #currProdQty").html("Current Quantity: "+n.Quantity);$('*[data-toggle="tooltip"]').tooltip({container:"body",placement:"right"})}})},c=function(){$("body").on("click","#btnnewform",function(){_doShowSaveForm()});$("body").on("click","#btnAddSalesDetails",function(){f()});$("body").on("click","#edititem",function(){$this=$(this);$('[data-edit-selected="true"]').removeClass("selected");$this.addClass("selected");$("#mdleditorderlist").modal({show:!0,backdrop:"static",keyboard:!1})});$("body").on("click","#removeitem",function(){$this=$(this);$this.removeClass("selected");var n=$("#gvSalesOderList").data("kendoGrid");n.removeRow($this);n.refresh();t()});$("body").on("shown.bs.modal","#mdleditorderlist",function(){$(document).off("focusin.modal");$("#frmEditOrderList #EditQuantity").val($this.data("orderlist-quantity"));$("#frmEditOrderList #EditPrice").val($this.data("orderlist-unitprice"));$("#frmEditOrderList #EditProductName").val($this.data("orderlist-productname"))});$("body").on("hidden.bs.modal","#mdleditorderlist",function(){$("#frmEditOrderList").deserialize(n.defaultEditValue,!0,null)});$("body").on("change","#frmSalesOrderDetail #ProductId",function(){var n=$("#frmSalesOrder #CustomerId").data("kendoDropDownList").value(),t=$("#frmSalesOrderDetail #ProductId").data("kendoDropDownList").value();n==""||n==0?toastr.error("please select customer first"):s(n,t)});$("body").on("click","#btnSaveSalesDetails",function(){e()});$("body").on("click","#btnSaveQueueDetails",function(){o()});$("body").on("click","#btnEditOrderList",function(){var i=$("#gvSalesOderList").data("kendoGrid"),u=$('[data-edit-selected="true"].selected'),f=i.dataSource._data,n=0,t=0,r=0,e=u.data("orderlist-productid");n=$("#frmEditOrderList #EditQuantity").val();t=$("#frmEditOrderList #EditPrice").val();r=t*n;$.each(f,function(){var i=$(this)[0],u;u=i.ProductId;u==e&&(i.Quantity=n,i.SalesPrice=r.toFixed(2),i.UnitPrice=t)});i.refresh();$("#mdleditorderlist").modal("hide");INFRA.doRemoveOpenedModal()})},l=function(){$("#frmSalesOrder #CustomerId").kendoDropDownList({filter:"contains",optionLabel:"- Select One -",dataTextField:"CustomerDropDownDisplay",dataValueField:"CustomerId",dataSource:{transport:{read:{dataType:"json",url:n.params.customerUrl}}}});$("#frmSalesOrderDetail #ProductId").kendoDropDownList({filter:"contains",optionLabel:"- Select One -",dataTextField:"ProductDropDownDisplay",dataValueField:"ProductId",dataSource:{transport:{read:{dataType:"json",url:n.params.productUrl}}}})},a=function(r){try{n.params=r||{};c();l()}catch(u){typeof console!="undefined"&&console!==null&&console.error("Error parsing inline options",ex)}n.defaultSaveValue=$("#frmSave").serialize();n.defaultEditValue=$("#frmEditOrderList").serialize();n.defaultSalesOrderDetailValue=$("#frmSalesOrderDetail").serialize();n.defaultSalesOrderValue=$("#frmSalesOrder").serialize();n.defaultEditQtyValue=$("#frmEditQty").serialize();n.defaultSearchValue=$("#frmSearch").serialize();n.qtyType="";i();t()};return{initialize:a,_variables:n}}();$(document).ready(function(){var t=window.salesOrderOptions,n;ORDERMANAGEMENTSALESORDER.initialize(t);n=$("#gvSalesOderList");n.kGridResizeHeight({height:ORDERMANAGEMENTSALESORDER._variables.gvHeight,willRefreshGrid:!1,isManual:!0});$(window).resize(function(){n.kGridResizeHeight({height:ORDERMANAGEMENTSALESORDER._variables.gvHeight,willRefreshGrid:!1,isManual:!0})})});
//# sourceMappingURL=ordermanagement-salesorder.min.js.map
